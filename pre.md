# Stock and Sales Module\n\n## 1. Dashboard\n\nThe dashboard provides a centralized view of pending tasks and operational metrics, letting users quickly act on approvals, monitor deliveries, and access key reports.\n\n```json\n{\"brsDiagram\": {}}\n```\n\n**Pending Approvals Widget**\n\nShort summary: Lists all transactions awaiting user approval, grouped by module and priority.\n\nInputs:\n- Current user’s roles and group assignments\n- Approval status filter = “Pending”\n\nProcess:\n1. Query all transactions where status = “Pending” and approver group matches user\n2. Sort by creation date ascending\n3. Aggregate counts per module\n\nOutputs:\n- A table of pending items with:\n  • Approval ID\n  • Module Name\n  • Created By\n  • Created Date\n  • Priority\n\nSample data:\n\n| Approval ID | Module              | Created By | Created Date | Priority | Status  |\n|-------------|---------------------|------------|--------------|----------|---------|\n| APPR-001    | Purchase Order      | jdoe       | 2024-06-10   | High     | Pending |\n| APPR-002    | QC Approval         | asmith     | 2024-06-11   | Medium   | Pending |\n| APPR-003    | Goods Received Note | jdoe       | 2024-06-12   | Low      | Pending |\n| APPR-004    | Damage Return       | bwong      | 2024-06-13   | High     | Pending |\n| APPR-005    | Service Invoice     | asmith     | 2024-06-14   | Medium   | Pending |\n| APPR-006    | Goods Transfer      | jdoe       | 2024-06-15   | Low      | Pending |\n| APPR-007    | Invoice Entry       | bwong      | 2024-06-16   | High     | Pending |\n\n**Lorry GPS Tracking Module**\n\nShort summary: Displays live location and status of each delivery lorry on map and list.\n\nInputs:\n- Lorry ID from GPS device feed\n- Latitude, Longitude, Timestamp, Speed\n\nProcess:\n1. Receive feed via secure endpoint every minute\n2. Validate timestamp (reject future times)\n3. Persist record in `lorry_tracking` table\n4. Query latest coordinate per lorry for display\n\nOutputs:\n- Map markers showing real-time position\n- List view with latest status per vehicle\n\nSample data:\n\n| Lorry ID | Timestamp           | Latitude | Longitude | Speed (km/h) | Status   |\n|----------|---------------------|----------|-----------|--------------|----------|\n| LRY-001  | 2024-06-16 08:15:00 | 6.9271   | 79.8612   | 45           | En Route |\n| LRY-002  | 2024-06-16 08:16:00 | 6.9275   | 79.8620   | 0            | Idle     |\n| LRY-003  | 2024-06-16 08:17:00 | 6.9280   | 79.8630   | 60           | En Route |\n| LRY-004  | 2024-06-16 08:18:00 | 6.9285   | 79.8640   | 30           | En Route |\n| LRY-005  | 2024-06-16 08:19:00 | 6.9290   | 79.8650   | 0            | At Depot |\n| LRY-006  | 2024-06-16 08:20:00 | 6.9295   | 79.8660   | 50           | En Route |\n| LRY-007  | 2024-06-16 08:21:00 | 6.9300   | 79.8670   | 55           | En Route |\n\n**Data Entry Period Control Module**\n\nShort summary: Enforces start/end dates for data entry per module and user group.\n\nInputs:\n- Module code (e.g., “PO”, “GRN”)\n- User group ID\n- Current system date\n\nProcess:\n1. Retrieve allowed date range from `entry_period` table\n2. Compare current date to range\n3. Grant or deny data entry access\n\nOutputs:\n- Access flag: Allowed / Denied\n- If denied, user sees \"Entry period closed for this module\"\n\n**Audit Trail Viewer Module**\n\nShort summary: Displays log of all user actions for compliance and troubleshooting.\n\nInputs:\n- Date range\n- Module filter\n- User filter\n\nProcess:\n1. Query `audit_log` table for matching records\n2. Paginate by 50 entries per page\n3. Group by action type for summary view\n\nOutputs:\n- Table with:\n  • Timestamp\n  • Username\n  • Action (Create/Update/Delete/Approve)\n  • Affected Record ID\n\n\n## 2. Common Settings\n\nThis screen lets administrators configure global parameters—data entry windows, audit trail retention, material-issue permissions, and numerical precision—to align with company policy and legacy behavior.\n\n```json\n{\"brsDiagram\": {}}\n```\n\n**Form Fields & Validation**\n\n| Field Name                   | Data Type | Required | Validation Rules                            | Editable By      |\n|------------------------------|-----------|----------|---------------------------------------------|------------------|\n| Data Entry Module            | Dropdown  | Yes      | Must select one of configured modules       | Admin Group      |\n| User Group                   | Multi-select | Yes   | Must choose at least one user group         | Admin Group      |\n| Start Date                   | Date      | Yes      | Cannot be in the past                       | Admin Group      |\n| End Date                     | Date      | Yes      | Must be ≥ Start Date                        | Admin Group      |\n| Audit Trail Retention (days) | Integer   | Yes      | 1–365                                       | Audit Admin      |\n| Decimal Places               | Integer   | Yes      | 0–6                                         | Admin Group      |\n| Material Issue Category      | Multi-select | No   | Values from `issue_category` master file    | Warehouse Admin  |\n\n**Data Entry Period Control**\n\nInputs:\n- Selected module\n- Selected user groups\n- Defined date range\n\nProcess:\n1. Save to `entry_period` master table\n2. Enforce checks on transaction screens\n\nOutputs:\n- New or updated period entry\n- Confirmation message\n\n**Material Issue Category Permission**\n\nInputs:\n- Issue categories\n- User group assignments\n\nProcess:\n1. Map categories to groups in `issue_permission` table\n2. Enforce permission on Material Issue screens\n\nOutputs:\n- Access granted/denied per category\n\n\n## 3. Brand Master\n\nAllows creation and maintenance of product brands—SMAK, TRADING, RAW MATERIAL, FILLING—forming the top level of the product hierarchy.\n\n```json\n{\"brsDiagram\": {}}\n```\n\n**Brand Management Modules**\n\n**Add Brand**\n\nInputs:\n- Brand Code (text, unique)\n- Brand Name (text)\n- Brand Type (enum: SMAK/TRADING/RAW MATERIAL/FILLING)\n- Active Flag (checkbox)\n\nProcess:\n1. Validate code uniqueness\n2. Insert into `brand_master`\n\nOutputs:\n- New brand record\n- Success or error message\n\n**Edit Brand**\n\nInputs:\n- Selected Brand Code\n- Editable fields (Name, Type, Active)\n\nProcess:\n1. Validate changes (e.g., type still in allowed list)\n2. Update record\n\nOutputs:\n- Updated record\n- Change log in audit trail\n\n**Delete Brand**\n\nInputs:\n- Selected inactive brand code\n\nProcess:\n1. Check no products are linked\n2. Mark as deleted or inactive\n\nOutputs:\n- Soft-delete flag set\n\n**Sample Brands**\n\n| Brand Code | Brand Name      | Brand Type    | Active | Created Date | Modified Date |\n|------------|-----------------|---------------|--------|--------------|---------------|\n| BR001      | Smak Original   | SMAK          | Yes    | 2024-01-10   | 2024-04-05    |\n| BR002      | Trading Delight | TRADING       | Yes    | 2024-02-15   | 2024-05-01    |\n| BR003      | RawEssence      | RAW MATERIAL  | No     | 2023-11-20   | 2024-03-12    |\n| BR004      | FillMaster      | FILLING       | Yes    | 2024-03-08   | 2024-06-01    |\n| BR005      | Smak Plus       | SMAK          | Yes    | 2024-01-25   | 2024-05-10    |\n| BR006      | Trading Pro     | TRADING       | Yes    | 2024-02-28   | 2024-06-08    |\n| BR007      | RawRich         | RAW MATERIAL  | No     | 2023-12-05   | 2024-04-20    |\n\n\n## 4. Group Master\n\nManages sub-categories of brands—190 GLASS, WATER, PET, TETRA, RAW, SNACK, BITE—and links each to a brand.\n\n```json\n{\"brsDiagram\": {}}\n```\n\n**Group Management**\n\nInputs:\n- Group Code (unique)\n- Group Name (text)\n- Brand Code (dropdown)\n- Active Flag\n\nProcess:\n1. Ensure brand exists and is active\n2. Insert/update `group_master`\n\nOutputs:\n- List of all groups\n- Audit entry\n\nSample data omitted for brevity (same pattern as Brand Master).\n\n\n## 5. Category Master\n\nDefines product categories—190 FRUIT, 190 MILK, WATER, TETRA, HOT & SPICY, KISSES—linked to a group.\n\n```json\n{\"brsDiagram\": {}}\n```\n\nSimilar modules to Brand/Group with fields: Category Code, Name, Group Code, Active.\n\n\n## 6. Subcategory Master\n\nCaptures the lowest level—MILK, FRUIT LABEL, LID, CONTAINER—linked to category only.\n\n```json\n{\"brsDiagram\": {}}\n```\n\nFields: Subcategory Code, Name, Category Code, Active.\n\n\n## 7. Product Master\n\nCentral screen for product definition, auto-populating brand/group from selected subcategory and handling QC flags, capacity, expiry, pricing tiers, WIP/Pulp mapping.\n\n```json\n{\"brsDiagram\": {}}\n```\n\n**Key Inputs**\n- Product Code (unique)\n- Name\n- Subcategory Code (dropdown)\n- Capacity (L or Kg)\n- QC Flag (Yes/No)\n- Expiry Required (Yes/No)\n- Batch Type (Batch/FIFO)\n- Pricing Levels (table upload)\n- Conversion % for Pulp\n- Validity Period Code\n\n**Processes**\n1. Auto-fill Brand & Group from hierarchy\n2. Validate expiry rules\n3. Upload multiple price levels via Excel parser\n4. Save mapping for WIP/Pulp\n\n**Outputs**\n- Searchable product list\n- Downloadable Excel template for price upload\n\n\n## 8. QC Parameter Master\n\nMaintains quality-check parameters for QC inspections.\n\n```json\n{\"brsDiagram\": {}}\n```\n\nFields: Parameter Code, Name, Measurement Unit, Min/Max Values, Linked Products.\n\n\n## 9. Purchase Order Entry\n\nAllows creation of new purchase orders, enforcing QC vs non-QC separation, validity periods, certificate checks, and multi-level approvals.\n\n```json\n{\"brsDiagram\": {}}\n```\n\n**Inputs**\n- PO Number (auto)\n- Supplier Code\n- Order Date\n- Validity Period (dropdown)\n- Line Items: Product, Quantity, QC Flag, Attached Certificate\n\n**Validation**\n- Reject mixed QC and non-QC in single PO\n- Block if certificate required but not uploaded or expired\n\n**Approval Workflow**\n1. Data Entry → Purchasing Manager → Finance\n2. Separate bulk-PO approval path\n\n**Outputs**\n- Email sent to supplier upon final approval with PO PDF\n- Approval serial number recorded\n\n\n## 10. Purchase Order Approval\n\nDedicated screen for managers to approve or reject POs with bulk-action and audit trail.\n\n```json\n{\"brsDiagram\": {}}\n```\n\n**Inputs**\n- List of POs pending user’s approval\n- Selection checkboxes\n- Approval decision (Approve/Reject)\n- Comments field\n\n**Process**\n1. Update `po_header`.`status` = Approved or Rejected\n2. Record approver, timestamp, comments\n3. On approval, trigger email and move to next approver or close\n\n**Outputs**\n- Updated PO status\n- Notification to next role or originator\n\n\n---\n\n*This initial Business Requirements Specification covers the Stock & Sales Module’s core interfaces and workflows. Further screens for receiving, returns, sales, loading, invoicing, transfers, damage returns, and reporting will follow in subsequent iterations.*